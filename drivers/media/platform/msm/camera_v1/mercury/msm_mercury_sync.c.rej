--- drivers/media/platform/msm/camera_v1/mercury/msm_mercury_sync.c
+++ drivers/media/platform/msm/camera_v1/mercury/msm_mercury_sync.c
@@ -24,6 +24,7 @@
 #include "msm_mercury_macros.h"
 #include "msm_mercury_hw_reg.h"
 
+#define UINT32_MAX    (4294967295U)
 static struct msm_mercury_core_buf out_buf_local;
 static struct msm_mercury_core_buf in_buf_local;
 
@@ -470,7 +471,7 @@
 	void * __user arg)
 {
 	int is_copy_to_user;
-	int len;
+	uint32_t len;
 	uint32_t m;
 	struct msm_mercury_hw_cmds *hw_cmds_p;
 	struct msm_mercury_hw_cmd *hw_cmd_p;
@@ -479,7 +480,12 @@
 		MCR_PR_ERR("%s:%d] failed\n", __func__, __LINE__);
 		return -EFAULT;
 	}
-
+	if ((m == 0) || (m > ((UINT32_MAX-sizeof(struct msm_mercury_hw_cmds))/
+		sizeof(struct msm_mercury_hw_cmd)))) {
+		MCR_PR_ERR("%s:%d] outof range of hwcmds\n",
+			__func__, __LINE__);
+		return -EINVAL;
+	}
 	len = sizeof(struct msm_mercury_hw_cmds) +
 		sizeof(struct msm_mercury_hw_cmd) * (m - 1);
 	hw_cmds_p = kmalloc(len, GFP_KERNEL);
